generator client {
  provider = "prisma-client-js"
  adapter  = "pg"
}

datasource db {
  provider = "postgresql"
}

model Hero {
  id           String @id @default(cuid())
  highlight    String
  title        String
  subtitle     String
  cta          String
  secondaryCta String
}

model Service {
  id              String  @id @default(cuid())
  slug            String  @unique
  title           String
  highlight       String?
  subtitle        String?
  description     String
  descriptionLong String?
  ctaText         String?
  seoTitle        String?
  seoDescription  String?
  iconName        String
  features        String[]
  active          Boolean @default(true)
}

model Product {
  id              String  @id @default(cuid())
  slug            String  @unique
  title           String
  description     String
  descriptionLong String?
  price           String
  ctaText         String?
  seoTitle        String?
  seoDescription  String?
  iconName        String
  active          Boolean @default(true)
}

model SiteConfig {
  id          String @id @default(cuid())
  name        String
  description String
  email       String
  address     String
  linkedin    String
  twitter     String?
}

model CmsSnapshot {
  id        String   @id
  data      Json
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model CmsSnapshotVersion {
  id           String   @id @default(cuid())
  snapshotId   String
  section      String
  data         Json
  createdAt    DateTime @default(now())
  createdById  String?
  createdBy    String?
  note         String?

  @@index([snapshotId, section, createdAt(sort: Desc)])
}

model AdminAuditLog {
  id            String   @id @default(cuid())
  actorUserId    String?
  actorUsername  String?
  actorRole      String?
  action         String
  resource       String
  resourceId     String?
  section        String?
  metadata       Json?
  createdAt      DateTime @default(now())

  @@index([resource, createdAt(sort: Desc)])
  @@index([actorUserId, createdAt(sort: Desc)])
}

model TranslationCache {
  key       String   @id
  targetLang String
  payload   Json
  provider  String
  model     String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model PrivacyConsentAcceptance {
  id            String   @id @default(cuid())
  visitorId      String
  sessionId      String?
  policyVersion  String
  policyHash     String
  path           String?
  country        String?
  region         String?
  city           String?
  userAgent      String?
  metadata       Json?
  acceptedAt     DateTime @default(now())

  @@index([acceptedAt(sort: Desc)])
  @@index([visitorId, acceptedAt(sort: Desc)])
  @@index([policyVersion, acceptedAt(sort: Desc)])
}

model AnalyticsEvent {
  id         String   @id @default(cuid())
  visitorId   String
  sessionId   String?
  eventType   String
  path        String?
  pageTitle   String?
  sectionId   String?
  durationMs  Int?
  country     String?
  region      String?
  city        String?
  referrer    String?
  metadata    Json?
  createdAt   DateTime @default(now())

  @@index([createdAt(sort: Desc)])
  @@index([eventType, createdAt(sort: Desc)])
  @@index([path, createdAt(sort: Desc)])
  @@index([sectionId, createdAt(sort: Desc)])
  @@index([country, createdAt(sort: Desc)])
}

enum AdminRole {
  SUPERADMIN
  ADMIN
  EDITOR
  ANALYST
}

model AdminUser {
  id           String    @id @default(cuid())
  username     String    @unique
  email        String?   @unique
  displayName  String
  role         AdminRole @default(ADMIN)
  passwordHash String
  active       Boolean   @default(true)
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
  lastLoginAt  DateTime?
}
